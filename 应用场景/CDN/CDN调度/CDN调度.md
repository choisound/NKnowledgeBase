# CDN调度

## GSLB

GSLB（Global Server Load Balancing）是一种通过智能流量调度优化用户访问体验的全局负载均衡技术，其核心目标是根据用户地理位置、服务器负载和网络状态，将请求分发至最优的数据中心或服务器集群。以下是其工作原理的深度解析：

### ​基于DNS的调度

**​原理**
用户发起域名解析请求时，GSLB设备作为权威DNS服务器介入，根据用户Local DNS的IP地址（或通过EDNS协议获取真实用户IP）判断地理位置，并结合后端服务器的健康状态返回最优IP地址。
示例流程：
用户请求解析 www.example.com；
Local DNS向GSLB设备发起查询；
GSLB根据用户IP匹配就近数据中心，返回对应IP；
用户直接访问目标服务器。
​优势：兼容性强，无需客户端改造，支持所有协议。
​局限：依赖Local DNS的准确性，可能因DNS缓存导致调度偏差。

### ​基于HTTP重定向的调度

​**原理**
用户首次请求到达默认服务器后，GSLB通过HTTP 302响应返回最优服务器地址。例如，用户访问CDN资源时，经过多次跳转最终定位到边缘节点。
示例流程：
用户访问 download.example.com/file；
初始服务器返回302重定向至 edge-us.example.com/file；
客户端重新请求边缘节点获取资源。
​优势：直接获取用户真实IP，调度更精准。
​局限：仅适用于HTTP/HTTPS协议，增加额外请求延迟。

### ​基于IP欺骗（三角传输）的调度

​**原理**
GSLB设备作为中间代理，将用户请求转发至最优服务器，但响应包的源IP伪装为GSLB设备IP，形成“客户端→GSLB→服务器→客户端”的三角路径。
​优势：支持所有TCP/UDP协议，客户端无感知。
​局限：性能开销大，依赖特定网络设备支持。